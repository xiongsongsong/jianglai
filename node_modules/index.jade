!!!5
html
    head
        title jianglai
        meta(charset="utf-8")
        style
            * {
                margin: 0;
                padding: 0;
            }

            body {
                background: #EA5C0F;
            }

            #navigation {
                background: url(http://img04.taobaocdn.com/tps/i4/T1w56xXipfXXcKEMnc-30-38.png);
                height: 38px;
                text-align: center;
                font-family: "Microsoft Yahei", simsun, sans-serif;
            }

            #navigation a {
                color: #fff;
                text-decoration: none;
                display: inline-block;
                height: 35px;
                padding: 0 3em;
                line-height: 32px;
            }

            #navigation a:hover {
                background: #666;
            }

            .ks-waterfall {
                position: absolute;
                width: 192px;
                overflow: hidden;
                padding: 13px;
                border: 1px solid #ddd;
                margin-bottom: 20px;
                text-align: center;
                left: -9999px;
                top: -9999px;
                filter: progid:DXImageTransform.Microsoft.gradient(enabled = 'true', startColorstr = '#EAFFFFFF', endColorstr = '#EAFFFFFF');
                background: rgba(255, 255, 255, 0.92);
                box-shadow: 2px 2px 2px #700;
            }

            .ks-waterfall img {
                display: inline-block;
                position: relative;
            }

            #main-container {
                width: 990px;
                margin: 0 auto;
                padding-top: 1em;
            }

            .container {
                position: relative;
                width:990px;
                display:none;
            }
            body .index0{
                display:block;
            }
    body
        #navigation
            each item in htmlObj
                a(href="#")=item.title.replace(/^[a-z]/gi,'')
        #main-container
            each item,index in htmlObj
                .container(class="index#{index}")
                    each list in item.data
                        .ks-waterfall
                            if(index<1)
                                img(src="upload/#{list.filename}",style="width:192px;height:#{list.height}px;")
                            else
                               img(data-src="upload/#{list.filename}",style="width:192px;height:#{list.height}px;")
        script(src="http://a.tbcdn.cn/s/kissy/1.2.0/kissy-min.js")
        script
            KISSY.use("waterfall", function (S, Waterfall) {
                var DOM = S.DOM, Event = S.Event;
                var container=DOM.query('.container');
                 DOM.attr(container[0],'is-water','true')
                new Waterfall({
                    container:container[0], //\u8282\u70B9\u5BB9\u5668
                    minColCount:2, //\u6700\u5C0F\u5217\u6570
                    colWidth:235  //\u6BCF\u5217\u7684\u5BBD\u5EA6
                });
                var navObj = DOM.query('#navigation a');
                var containerObj = DOM.query('div.container');
                if(navObj.length>1){
                    Event.on(navObj, 'click', function (ev) {
                        var target = ev.currentTarget;
                        DOM.hide(containerObj);
                        var currentContainer=containerObj[S.indexOf(target, navObj)];
                        DOM.show(currentContainer);
                        if(DOM.attr(currentContainer,'is-water')!=='true'){
                            new Waterfall({
                                container:currentContainer,
                                minColCount:2,
                                colWidth:235
                            });
                            S.each(DOM.query('img',currentContainer),function(item,index){
                                item.src=DOM.attr(item,'data-src');
                            })
                            DOM.attr(currentContainer,'is-water','true')
                        }
                    });
                }
             });